- include: docker-dowload.yml
  when: clickhouse_rt_is_installed.rc == 0 and clickhouse_remove|bool == False
  tags: [config,config_sys]

- include: config_sys.yml
  when: clickhouse_rt_is_installed.rc == 0 and clickhouse_remove|bool == False
  tags: [config,config_sys]

- name: Wait DBMS ready
  command: sleep 1

- include: config_db.yml
  when: clickhouse_rt_is_installed.rc == 0 and clickhouse_remove|bool == False
  tags: [config,config_db]

- include: config_dict.yml
  when: clickhouse_rt_is_installed.rc == 0 and clickhouse_remove|bool == False
  tags: [config,config_dict]

- include: "{{ item }}"
  with_first_found:
    - "remove_{{ ansible_pkg_mgr }}.yml"
    - "empty.yml"
  when: clickhouse_setup == 'package' and clickhouse_rt_is_installed.rc == 0 and clickhouse_remove|bool == True
  tags: [remove]
